<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RF å¸‚å ´æƒ…å ±(é–å®š)</title>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <style>
        :root {
            --bg: #0f1115; --panel: #161b22; --border: #30363d;
            --text: #c9d1d9; --text-muted: #8b949e;
            --gold: #d29922; --green: #2ea043; --red: #ff5252; --blue: #58a6ff;
        }
        
        * { box-sizing: border-box; }
        *::-webkit-scrollbar { width: 6px; height: 6px; }
        *::-webkit-scrollbar-track { background: var(--bg); }
        *::-webkit-scrollbar-thumb { background: #444; border-radius: 3px; }
        *::-webkit-scrollbar-thumb:hover { background: var(--gold); }

        body { background: var(--bg); color: var(--text); font-family: "Microsoft JhengHei", sans-serif; margin: 0; padding: 20px; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
        
        /* === é–å®šç•«é¢æ¨£å¼ (æ–°å¢) === */
        #loginOverlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: var(--bg); z-index: 9999;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
        }
        .login-box {
            background: var(--panel); padding: 40px; border-radius: 12px;
            border: 1px solid var(--border); text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.8);
        }
        .login-title { color: var(--gold); margin-bottom: 20px; font-weight: bold; letter-spacing: 2px; }
        .login-input {
            background: #0d1117 !important; border: 1px solid var(--border) !important; color: var(--gold) !important;
            padding: 10px; font-size: 1.5em; text-align: center; letter-spacing: 5px;
            width: 200px; border-radius: 6px; margin-bottom: 20px; font-family: 'Consolas', monospace;
        }
        .login-btn {
            background: var(--gold); color: #000; border: none; padding: 10px 30px;
            font-weight: bold; cursor: pointer; border-radius: 4px; transition: 0.2s;
        }
        .login-btn:hover { filter: brightness(1.1); }

        /* åŸæœ‰æ¨£å¼ */
        .container { display: flex; gap: 20px; height: 100%; }
        .sidebar { width: 320px; background: var(--panel); border: 1px solid var(--border); padding: 20px; border-radius: 8px; display: flex; flex-direction: column; flex-shrink: 0; overflow-y: auto; }
        .main-view { flex: 1; display: flex; flex-direction: column; gap: 20px; min-width: 0; overflow-y: auto; padding-right: 5px; }

        h2 { margin: 0 0 15px 0; font-size: 1.1em; color: var(--gold); border-bottom: 1px solid var(--border); padding-bottom: 10px; }
        .input-group { margin-bottom: 15px; }
        label { display: block; font-size: 0.8em; color: var(--text-muted); margin-bottom: 5px; }
        
        input, select, textarea { 
            width: 100%; padding: 10px; background: #0d1117; border: 1px solid #30363d; 
            color: #fff; border-radius: 4px; font-family: 'Consolas', monospace; font-size: 1em;
        }
        input[type="datetime-local"]::-webkit-calendar-picker-indicator { filter: invert(1); cursor: pointer; }
        input:focus, textarea:focus { outline: none; border-color: var(--gold); }
        
        .btn { width: 100%; padding: 12px; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; margin-top: 5px; transition: 0.2s; }
        .btn-add { background: var(--gold); color: #000; }
        .btn-import { background: var(--blue); color: #000; margin-top: 10px; }
        .btn:hover { filter: brightness(1.1); }
        
        .item-list { display: flex; flex-direction: column; gap: 5px; margin-top: 20px; }
        .item-card { 
            padding: 10px; background: rgba(255,255,255,0.03); border: 1px solid transparent; 
            cursor: pointer; border-radius: 4px; display: flex; justify-content: space-between; align-items: center;
        }
        .item-card:hover { background: rgba(255,255,255,0.08); }
        .item-card.active { border-color: var(--gold); background: rgba(210, 153, 34, 0.1); }

        .chart-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .chart-panel { background: var(--panel); border: 1px solid var(--border); border-radius: 8px; padding: 20px; min-height: 400px; position: relative; display: flex; flex-direction: column; }
        .stats-panel { background: var(--panel); border: 1px solid var(--border); border-radius: 8px; padding: 20px; flex: 0 0 auto; display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; }
        
        .history-panel { background: var(--panel); border: 1px solid var(--border); border-radius: 8px; padding: 20px; flex: 0 0 auto; }
        .history-table { width: 100%; border-collapse: collapse; font-size: 0.9em; }
        .history-table th { text-align: left; color: var(--text-muted); padding: 8px; border-bottom: 1px solid var(--border); }
        .history-table td { padding: 8px; border-bottom: 1px solid #2a2624; color: var(--text); }
        .history-table tr:hover { background: rgba(255,255,255,0.02); }
        .del-btn { background: none; border: none; color: #666; cursor: pointer; }
        .del-btn:hover { color: var(--red); }

        .time-toolbar { display: flex; gap: 5px; background: #0d1117; padding: 5px; border-radius: 6px; border: 1px solid var(--border); }
        .time-btn { 
            background: transparent; border: none; color: var(--text-muted); padding: 5px 10px; 
            cursor: pointer; font-size: 0.85em; border-radius: 4px; transition: 0.2s;
        }
        .time-btn:hover { color: #fff; background: rgba(255,255,255,0.1); }
        .time-btn.active { background: var(--gold); color: #000; font-weight: bold; }

        .stat-card { background: rgba(255,255,255,0.02); padding: 15px; border-radius: 6px; text-align: center; }
        .stat-val { font-size: 1.4em; font-weight: bold; margin: 5px 0; font-family: 'Consolas', monospace; }
        .stat-label { font-size: 0.8em; color: var(--text-muted); }
        
        .trend-badge { font-size: 0.5em; padding: 2px 6px; border-radius: 4px; vertical-align: middle; margin-left: 5px; }
        .trend-rise { background: rgba(255, 82, 82, 0.2); color: #ff5252; }
        .trend-fall { background: rgba(46, 160, 67, 0.2); color: #3fb950; }
        
        .data-warning { 
            position: absolute; top: 60px; right: 20px; 
            background: rgba(255, 82, 82, 0.15); border: 1px solid var(--red); color: var(--red);
            padding: 5px 10px; border-radius: 4px; font-size: 0.8em; display: none; z-index: 10;
        }

        #importModal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8); z-index: 999; display: none;
            justify-content: center; align-items: center;
        }
        .modal-content {
            background: var(--panel); border: 1px solid var(--border); padding: 25px;
            border-radius: 8px; width: 500px; max-width: 90%;
        }
        .close-btn { float: right; cursor: pointer; color: #fff; font-size: 1.2em; }
    </style>
</head>
<body>

<div id="loginOverlay">
    <div class="login-box">
        <div class="login-title">ACCESS LOCKED</div>
        <input type="password" id="passInput" class="login-input" placeholder="PASSCODE" onkeyup="checkEnter(event)">
        <br><button class="login-btn" onclick="checkPass()">UNLOCK</button>
    </div>
</div>

<div id="importModal">
    <div class="modal-content">
        <span class="close-btn" onclick="closeImport()">Ã—</span>
        <h2 style="color:var(--blue)">ğŸ“¥ æ‰¹é‡æ•¸æ“šåŒ¯å…¥</h2>
        <p style="color:#aaa; font-size:0.9em; margin-bottom:10px;">è«‹å°‡ AI ç”Ÿæˆçš„ JSON ä»£ç¢¼è²¼åœ¨ä¸‹æ–¹ï¼š</p>
        <textarea id="importArea" rows="10" placeholder='[{"name":"5è¬Cå¹£å¡", "low":2.4, "avg":2.331}, ...]'></textarea>
        <button class="btn btn-import" onclick="processImport()">ç¢ºèªåŒ¯å…¥</button>
    </div>
</div>

<div class="container">
    <div class="sidebar">
        <h2>ğŸ“ å¸‚å ´æƒ…å ±éŒ„å…¥</h2>
        
        <div class="input-group">
            <label style="color:var(--blue)">ç´€éŒ„æ™‚é–“</label>
            <input type="datetime-local" id="inTime">
        </div>

        <div class="input-group"><label>ç‰©å“åç¨±</label><input list="itemList" id="inName" placeholder="æœå°‹æˆ–è¼¸å…¥..."><datalist id="itemList"></datalist></div>
        
        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
            <div class="input-group"><label style="color:var(--gold)">æœ€ä½ç™»éŒ„åƒ¹</label><input type="number" id="inLowPrice" step="0.001"></div>
            <div class="input-group"><label style="color:var(--green)">æ¯é€±å¹³å‡åƒ¹</label><input type="number" id="inAvgPrice" step="0.001"></div>
        </div>
        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px; opacity: 0.9;">
            <div class="input-group"><label>æœ€å¾Œæˆäº¤</label><input type="number" id="inLastPrice" step="0.001"></div>
            <div class="input-group"><label style="color:var(--text)">ç™»éŒ„æ•¸é‡ (è³£å£“)</label><input type="number" id="inQty"></div>
        </div>

        <button class="btn btn-add" onclick="addData()">ğŸ“¸ è¨˜éŒ„å–®ç­†</button>
        <button class="btn btn-import" onclick="openImport()">ğŸ“¥ æ‰¹é‡è²¼ä¸Š</button>
        <button class="btn" style="background:#21262d; color:#8b949e; border:1px solid #30363d;" onclick="clearInputs()">æ¸…é™¤</button>

        <h2 style="margin-top:20px;">ğŸ“‚ è¿½è¹¤æ¸…å–®</h2>
        <div id="trackedItems" class="item-list"></div>
    </div>

    <div class="main-view">
        <div class="stats-panel">
            <div class="stat-card"><div class="stat-label">ç›®å‰æœ€ä½</div><div class="stat-val" style="color:var(--gold)" id="dispCurrent">--</div></div>
            <div class="stat-card"><div class="stat-label">é€±å¹³å‡ç·š</div><div class="stat-val" style="color:var(--green)" id="dispAvg">--</div></div>
            <div class="stat-card"><div class="stat-label">è³£å£“ç›£æ§ (æ•¸é‡)</div><div class="stat-val" id="dispVolStatus" style="font-size:1.1em;">--</div></div>
            <div class="stat-card"><div class="stat-label">å¸‚å ´ç‹€æ…‹</div><div class="stat-val" id="dispStatus" style="font-size:1.1em;">--</div></div>
        </div>

        <div class="chart-panel">
            <div class="chart-header">
                <div style="font-weight:bold; color:#fff;" id="chartTitle">è¶¨å‹¢åœ–è¡¨</div>
                <div class="time-toolbar">
                    <button class="time-btn" onclick="setTimeRange(10)">10åˆ†</button>
                    <button class="time-btn" onclick="setTimeRange(30)">30åˆ†</button>
                    <button class="time-btn" onclick="setTimeRange(60)">1H</button>
                    <button class="time-btn" onclick="setTimeRange(180)">3H</button>
                    <button class="time-btn" onclick="setTimeRange(1440)">1å¤©</button>
                    <button class="time-btn" onclick="setTimeRange(10080)">1é€±</button>
                    <button class="time-btn active" onclick="setTimeRange(0)" id="btnAll">å…¨éƒ¨</button>
                </div>
            </div>
            
            <div id="dataWarning" class="data-warning">âš ï¸ è³‡æ–™ä¸è¶³</div>
            <div id="priceChart" style="flex:1;"></div>
        </div>

        <div class="history-panel">
            <h2 style="font-size:1em; border-bottom:none; margin-bottom:10px;">ğŸ“œ è©³ç´°æ­·å²ç´€éŒ„</h2>
            <div style="max-height: 250px; overflow-y: auto;">
                <table class="history-table">
                    <thead><tr><th>æ™‚é–“</th><th>æœ€ä½åƒ¹</th><th>å‡åƒ¹</th><th>æˆäº¤</th><th>æ•¸é‡</th><th>æ“ä½œ</th></tr></thead>
                    <tbody id="historyBody"></tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<script src="rf_market.js"></script>

<script>
    const PASSWORD = "0000"; // é è¨­å¯†ç¢¼
    
    function checkPass() { 
        if(document.getElementById('passInput').value === PASSWORD) { 
            document.getElementById('loginOverlay').style.display = 'none'; 
        } else { 
            alert("å¯†ç¢¼éŒ¯èª¤"); 
            document.getElementById('passInput').value = ""; 
            document.getElementById('passInput').focus(); 
        } 
    }
    
    function checkEnter(e) { if(e.key === "Enter") checkPass(); }
    
    // é é¢è¼‰å…¥å¾Œè‡ªå‹•èšç„¦å¯†ç¢¼æ¡†
    document.addEventListener('DOMContentLoaded', function() {
        const passInput = document.getElementById('passInput');
        if(passInput) passInput.focus();
    });
</script>
</body>
</html>